Singkong Programming Language Interpreter
(c) Noprianto <nopri.anto@icloud.com>, 2019-2020
Website: nopri.github.io
License: Free to use or redistribute
Version: 1.9 (2020-Feb-02 +07:00)

Singkong is based on Monkey.java: an open source, simple implementation of 
Monkey programming language interpreter in Java.
Monkey.java is based on monkey.py: an open source, simple implementation of 
Monkey programming language interpreter in Python.
Monkey.java and monkey.py, (c) Noprianto <nopri.anto@icloud.com>, 2019.

monkey.py is based on code (in Go programming language) in book: 
WRITING AN INTERPRETER IN GO

=============================================================================

 1. What is Singkong Programming Language
 2. System requirements
 3. Getting started
 4. Identifier, keywords, data types, and operators
 5. Builtin functions
 6. If condition
 7. Repeat loop
 8. GUI application development
 9. Database application development
10. Calling Java method
11. Simple HTTP client
12. Embedding Singkong into another applications
13. Differences with Monkey Programming Language
14. Development, compatibility, and modules
15. Example: GUI: components
16. Example: GUI: layout
17. Example: GUI: Singkong information
18. Example: GUI: event handlers
19. Example: GUI: printing
20. Example: GUI: simple text file editor
21. Example: GUI: timer
22. Example: Database: create table
23. Example: Database: insert, update, select
24. Example: GUI/Database: select
25. Example: Java: Base64 encode/decode

-----------------------------------------------------------------------------

1. What is Singkong Programming Language
Singkong is case-insensitive, dynamically typed, procedural, and interpreted 
programming language that runs on Java Virtual Machine (Java 5.0 or later). 
It has numbers, booleans, strings, arrays, hash maps, dates, first-class 
functions, built-in functions, GUI components, database connections, and 
other features. Singkong program can also call Java method. 

Singkong interpreter comes with simple GUI editor/interactive evaluator. 

Singkong can be run on graphical or text user interfaces. It can also be 
embedded and integrated into another applications. Singkong is distributed as 
single jar file. 

Singkong is based on Monkey.java and inspired by Monkey Programming Language.


-----------------------------------------------------------------------------

2. System requirements
Java Runtime Environment version 5.0 or later.  

If only text-based environment is available, Singkong interactive evaluator 
will fallback to text only version and built-in functions will adapt 
appropriately.


-----------------------------------------------------------------------------

3. Getting started
Please download Singkong.jar from its website. The jar file can be saved into
any directory - no system wide installation is required. Using portable Java 
installation, Singkong can be run from external/portable storage device. 

If GUI is available, Singkong.jar comes with interactive evaluator, 
variable inspector, simple text editor, and documentation viewer.

To run Singkong in text mode when GUI is available, please set property
SINGKONG=0 (-DSINGKONG=0). This setting has no effect when GUI is not 
available.

To disable some built-in functions, please set property DISABLE (-DDISABLE) to 
comma-separated list of functions. 

- Standalone
  - No command line argument: interactive
        java -jar Singkong.jar

        Singkong 1.9
        Press ENTER to quit
        > let hello = "Hello World"
        > hello
        "Hello World"
        > 
        
  - No command line argument: interactive (GUI available)
        java -jar Singkong.jar

        (double-clicking Singkong.jar may also work)

  - No command line argument: interactive (run in text mode, GUI available)
        java -DSINGKONG=0 -jar Singkong.jar

  - No command line argument: interactive (disable built-in: system)
        java -DDISABLE=system -jar Singkong.jar

  - No command line argument: interactive (disable built-in: system and info)
        java -DDISABLE=system,info -jar Singkong.jar

  - Command line argument: try to interpret as file
        java -jar Singkong.jar test.singkong

    If exception occurred: interpret the argument as Singkong code
        java -jar Singkong.jar "puts(1,2,3)"
        1
        2
        3

  - Run directly the main class (please also read: Database application 
    development and Calling Java method):
        java -cp Singkong.jar com.noprianto.singkong.Singkong

        java -cp Singkong.jar com.noprianto.singkong.Singkong test.singkong

        java -cp Singkong.jar com.noprianto.singkong.Singkong "puts(1,2,3)"
        
        java -DSINGKONG=0 -cp Singkong.jar com.noprianto.singkong.Singkong "puts(1,2,3)"

- Library
  Please read: Embedding Singkong into another applications 

Note: please use built-in function: interactive, to get information whether 
Singkong program is run in Singkong interactive evaluator/editor. 


-----------------------------------------------------------------------------

4. Identifier, keywords, data types, and operators
Identifier starts with letter or underscore and optionally followed by letters,
numbers, or underscores. Built-in function names and keywords cannot be used as 
identifier.

Assignment is done using let statements:
let name = "singkong";
let f = fn(name) { puts(name) }

Note:
- Statement optionally ends with ; 
- Block statement starts with { and ends with }
- Comment starts with # and ends with ;
- Multi-line comment is supported

Comment:
# 
	this
	is
	a
	multi-line
	comment
;
println("Singkong")

# this is another comment;
println("Programming")

# this is also a comment
;
println("Language")

Keywords:
#
ELSE
FALSE
FN
IF
LET
NULL
REPEAT
RETURN
TRUE

Note: to get list of keywords, please use built-in function keywords.

Data types:
Related functions: builtins, eval, is, hash, print, println, puts, string, type, 
types

- NULL
  - null
  - null literal
  - null may also returned from built-in functions
  - null is not printed. To print null, please use 
    print, println, puts, or message. 
- NUMBER
  - any integer and decimal
  - precision: 10240, scale: 4
  - operators: + - * / == != %(remainder) ^(power) < <= > >=
  - related functions: abs, array_number, integer, number, number_group, 
    random, round, sort_number, words_en, words_id
  - system related functions: delay
  - sorting: by value
- BOOLEAN
  - true or false
  - operators: == != & |
  - related functions: sort_boolean
  - sorting: by value
- STRING
  - double-quoted
  - arbitrary length string
  - operators: +(concatenation) -(remove) ==(equals,case-sensitive) != *(repeat)
  - equals (case-insensitive): please use built-in function equals
  - related functions: array_string, call, center, count, cr, crlf, dir, empty, 
    endswith, equals, eval, in, index, join, left, len, lf, lower, matches, md5, 
    newline, quote, random_string, replace, right, set, sha1, sha256, sha384, 
    sha512, slice, sort_string, split, startswith, stat, tab, trim, upper
  - special characters: cr, crlf, lf, newline, quote, tab
  - file related functions: abs, append, read, write
  - system related functions: cwd, separator, user
  - Singkong related functions: load
  - sorting: lexicographically
- ARRAY
  - []
  - array of mixed data types
  - operators: +(add), -(remove) == !=
  - modify ARRAY: please use built-in function set
  - related functions: array, array_number, array_string, average, call, count, 
    each, empty, first, in, index, join, last, len, max, min, pop, push, 
    random, range, rest, reverse, shuffle, slice, sort_array, sort_boolean, 
    sort_date, sort_hash, sort_number, sort_string, sum
  - file related functions: dir
  - system related functions: arguments, system
  - sorting: by length
- HASH
  - {}
  - hash table/dictionary
  - any data type can be used as key
  - hash maintains insertion-order
  - operators: +(add dictionary), -(remove) == !=
  - modify HASH: please use built-in function set
  - related functions: empty, keys, len, parse_hash, random, sort_hash, values
  - file related functions: properties_read, properties_write, stat
  - system related functions: info
  - Singkong related functions: singkong
  - sorting: by length
- DATE
  - @ @Y @YY @YYY @YYYY @YYYYM @YYYYMM @YYYYMMD @YYYYMMDD @YYYYMMDDh 
    @YYYYMMDDhh @YYYYMMDDhhm @YYYYMMDDhhmm @YYYYMMDDhhmms @YYYYMMDDhhmmss
  - related functions: date, datetime, day, diff, format_date, format_datetime,
    format_diff, hour, minute, month, part, second, sort_date, year
  - file related functions: stat
  - sorting: before/after
- FUNCTION
  - fn()
  - fn(arg)
  - fn(arg, arg,...)
  - function definition: let statement
  - function call: function name followed by (, optional comma-separated 
    arguments, and )
  - related functions: do, each, param
- BUILTIN
  - built-in function
  - related functions: builtins, disabled, help, param
- COMPONENT
  - Please read: GUI application development
  - related functions: add, add_e, add_n, add_s, add_w, clear, closing, 
    component, component_type, components, config, event, frame, fonts, get, 
    gui, hide, printer, remove, remove_e, remove_n, remove_s, remove_w, reset, 
    screen, show, size, radio_group, table_add, table_remove, timer, title, stop 
  - GUI input/output functions: confirm, directory, input, open, message, 
    password, save
    (if GUI is not available: simpler text-based version)
- DATABASE
  - Please read: Database application development
  - related functions: database, database_connected, query


-----------------------------------------------------------------------------

5. Builtin functions
To get a list of built-in functions, please call builtins()
["ABS", "ADD", "ADD_E", "ADD_N", "ADD_S", "ADD_W", "APPEND", "ARGUMENTS", 
"ARRAY", "ARRAY_NUMBER", "ARRAY_STRING", "AVERAGE", "BUILTINS", "CALL", 
"CALL_INFO", "CENTER", "CLEAR", "CLOSING", "COMPONENT", "COMPONENT_TYPE", 
"COMPONENTS", "CONFIG", "CONFIRM", "COUNT", "CR", "CRLF", "CWD", "DATABASE", 
"DATABASE_CONNECTED", "DATE", "DATETIME", "DAY", "DELAY", "DIFF", "DIR", 
"DIRECTORY", "DISABLED", "DO", "EACH", "EMPTY", "ENDSWITH", "EQUALS", "EVAL", 
"EVENT", "EXIT", "FIRST", "FONTS", "FORMAT_DATE", "FORMAT_DATETIME", 
"FORMAT_DIFF", "FRAME", "GET", "GUI", "HASH", "HELP", "HIDE", "HOUR", 
"HTTP_DELETE", "HTTP_GET", "HTTP_GET_FILE", "HTTP_POST", "HTTP_POST_OVERRIDE", 
"HTTP_PUT", "IN", "INDEX", "INFO", "INPUT", "INTEGER", "INTERACTIVE", "IS", 
"JOIN", "KEYS", "KEYWORDS", "LAST", "LEFT", "LEN", "LF", "LOAD", "LOWER", 
"MATCHES", "MAX", "MD5", "MESSAGE", "MIN", "MINUTE", "MONTH", "NEWLINE", 
"NUMBER", "NUMBER_GROUP", "OPEN", "PARAM", "PARSE_HASH", "PART", "PASSWORD", 
"POP", "PRINT", "PRINTER", "PRINTLN", "PROPERTIES_READ", "PROPERTIES_WRITE", 
"PUSH", "PUTS", "QUERY", "QUOTE", "RADIO_GROUP", "RANDOM", "RANDOM_STRING", 
"RANGE", "READ", "REMOVE", "REMOVE_E", "REMOVE_N", "REMOVE_S", "REMOVE_W", 
"REPLACE", "RESET", "REST", "REVERSE", "RIGHT", "ROUND", "SAVE", "SCREEN", 
"SECOND", "SEPARATOR", "SET", "SHA1", "SHA256", "SHA384", "SHA512", "SHOW", 
"SHUFFLE", "SINGKONG", "SIZE", "SLICE", "SORT_ARRAY", "SORT_BOOLEAN", 
"SORT_DATE", "SORT_HASH", "SORT_NUMBER", "SORT_STRING", "SPLIT", "STARTSWITH", 
"STAT", "STOP", "STRING", "SUM", "SYSTEM", "TAB", "TABLE_ADD", "TABLE_REMOVE", 
"TIMER", "TITLE", "TRIM", "TYPE", "TYPES", "UPPER", "URL_DECODE", "URL_ENCODE", 
"USER", "VALUES", "WORDS_EN", "WORDS_ID", "WRITE", "YEAR"]

>  len(builtins())
164

Note: a built-in function may be disabled when the interpreter in run. In such
case, an error will be returned when the function is called. 

To get basic information of a built-in function, please enter its name in
interactive evaluator, without ( and ). For example:

>  random
built-in function: random: returns random number (between 0 inclusive and 1 
exclusive), random number between min and max (both inclusive), random element 
in ARRAY, random key in HASH
arguments: 0, 1 (ARRAY or HASH), 2: (NUMBER and NUMBER)
return value: <any type>


-----------------------------------------------------------------------------

6. If condition
Syntax: if (condition) {consequences} else {alternatives}

condition: BOOLEAN
operators: &(and) |(or)

Example:
let name = "singkong";
if (name == "singkong") {
  print(name);
}

Note: HASH (key: condition, value: FUNCTION) may also be used 

-----------------------------------------------------------------------------

7. Repeat loop
repeat { statements }

To exit from loop, use return

Example:
let i = 0;
repeat {
  print(" " + i);
  let i = i + 1;
  if (i > 5) { return i };
}

Please also use do and each functions for simple repetitions:
- do: calls a function a number of times, optionally with arguments
- each: for each element in an ARRAY, calls a function a number of times 
  (with arguments). Specified function must accept two arguments: 
  the element and index (zero based).


-----------------------------------------------------------------------------

8. GUI application development
Singkong supports simple graphical user interface application development. 
To keep it as simple as possible:
- There is only one frame for each Singkong program. No other frames
  or dialogs can be created. An application can only have at most one top-level
  frame and no other dialogs. To show common dialogs, please use related
  built-in functions (confirm, directory, input, open, message, password, save).
  To set frame title, please use built-in function title.
  To set frame size, please use built-in function size (this might not work on 
  some system configuration and will be ignored).
  To get frame properties (width, height, title), please use built-in function
  frame.
  To reset frame (remove all COMPONENTs, reset frame title and size to default
  values, stop all timers), please use built-in function reset. 
- Every user interface component is a COMPONENT in Singkong.
- To create a user interface component, please use built-in function component.
  This function accepts two arguments: component type and name, both as string.
  Component type must be a valid component type, and name will be used both as
  name and important properties. For example, to create a button, "button" must
  be passed as component type and name is used as label of that button. 
  Different component may use name for different purposes. For example: when 
  creating a table, name (comma-separated string) is used as column names. 
  This function also accepts optional argument BOOLEAN: if true, created 
  component will be read-only (default: false). However, this only applicable 
  when creating edit, password, table, or text. 
- To get a list of supported component types, built-in function components can 
  be used. Currently, this function returns:
  ["button", "checkbox", "combobox", "edit", "image", "label", "password", 
  "radio", "table", "text"]
- To get type of a COMPONENT, please use built-in function component_type. This
  function returns component type as STRING (one of values returned by 
  components function, as above). 
- To add a COMPONENT or an ARRAY of COMPONENT to frame, please use one of the
  following built-in functions: add, add_e, add_n, add_s, add_w (which adds a 
  COMPONENT or an ARRAY of COMPONENT to specific region 
  (center, east, north, south, west) of frame. Existing components in that 
  region will be removed, prior to addition).
- To remove COMPONENTs from specific region (center, east, north, south, west) 
  of frame, please use one of the following built-in functions: remove, 
  remove_e, remove_n, remove_s, remove_w. To remove all COMPONENTs from frame, 
  please use built-in function clear. 
- To enable or disable frame closing confirmation, please use built-in function
  closing.
- To configure a COMPONENT, please use built-in function config. This function
  accepts three arguments: COMPONENT, STRING (key), and <any type> (value). 
  Different component may have different keys, but common keys are: 
  - enabled (for all components, expects value as BOOLEAN)
  - visible (for all components, expects value as BOOLEAN)
  - focus (for all components, expects value as BOOLEAN)
  - foreground/background (for all components, expects value as STRING (color name or RGB value))
  - font (for all components, expects value as ARRAY [STRING (font name), NUMBER (0=plain, 1=bold, 2=italic, 3=bold and italic), NUMBER (size)])
  - text (label of button/checkbox/label/radio, selected item of combobox, 
    expects value as STRING)
  - active (checkbox/radio expects value as BOOLEAN, combobox/table expects
    value as NUMBER (selected index))
  - contents (contents of combobox/edit/password/table/text, image file of
    image, expects value as STRING, ARRAY of ARRAY (table), or ARRAY (combobox))
  (configuration may be ignored if it is not applicable -- no errors will be
   returned).
- To get a configuration of a COMPONENT configured using config, please use
  built-in function get. This function accepts two arguments: COMPONENT and 
  STRING (key). 
  - enabled (for all components, returns a BOOLEAN)
  - visible (for all components, returns a BOOLEAN)
  - focus (for all components, returns a BOOLEAN)
  - foreground/background (for all components, returns a STRING (color name or RGB value))
  - font (for all components, returns an ARRAY [STRING (font name), NUMBER (0=plain, 1=bold, 2=italic, 3=bold and italic), NUMBER (size)])
  - text (label of button/checkbox/label/radio, selected item of combobox, 
    returns a STRING)
  - active (checkbox/radio returns a BOOLEAN, combobox/table returns a NUMBER)
  - contents (contents of combobox/edit/password/table/text, image file of 
    image, returns a STRING, an ARRAY of ARRAY (of STRING, table), 
    or an ARRAY (of STRING, combobox))
  (configuration may be ignored if it is not applicable and NULL will be
   returned).
- table: to add rows or remove a row, please use built-in function table_add or
  table_remove. 
- radio: to group an ARRAY of COMPONENT radio buttons (mutual-exclusion set), 
  please use built-in function radio_group.
- The following COMPONENTs have default event:
  - button: pressed
  - combobox: selected item changed
  - checkbox: checked/unchecked
  - radio: selected/deselected
  - table: selected item changed
  - edit/password/text: contents changed
  Event handlers for these events can be registered using built-in function
  event. This function accepts two arguments: COMPONENT and FUNCTION.
  Registered FUNCTION will be called whenever the default event for specified
  COMPONENT should be handled. 
  Please note that specified FUNCTION must not require any arguments.
- Printing: simple printing can be done using print dialog. To show a print
  dialog, please use built-in function printer. Basic settings such as 
  font name, font size, left/top margin are supported. 
- To get the size of the screen, please use built-in function screen.
- To calls a FUNCTION every specified delay, please use built-in function timer.
  This function accepts two arguments: NUMBER (delay in milliseconds) and
  FUNCTION. To stop all timers, please use built-in function stop. 
- To get list of available fonts, please use built-in function fonts.


-----------------------------------------------------------------------------

9. Database application development
Singkong supports simple database application development (SQL relational 
database management system). 
- Every connection to a database system is a DATABASE in Singkong.
- To connect to a database system, please use built-in function database. This
  function accepts four arguments:
  - STRING: database driver, Java class found in class path
  - STRING: database URL
  - STRING: user
  - STRING: password
- Singkong.jar does not contain any database driver. In order to use database
  driver from another jar file/directory, please run Singkong using the 
  following command:
  java -cp Singkong.jar:<jar> com.noprianto.singkong.Singkong
  or
  java -cp Singkong.jar:<dir> com.noprianto.singkong.Singkong
  or
  java -cp Singkong.jar;<jar> com.noprianto.singkong.Singkong
  or
  java -cp Singkong.jar;<dir> com.noprianto.singkong.Singkong
  where <jar> is a jar file and <dir> is a directory containing database driver 
  class. Please note that class path separator character is operating system 
  dependent (: or ;). If the driver class file is located in current working 
  directory, <dir> might be replaced with a ., for example:
  java -cp Singkong.jar:. com.noprianto.singkong.Singkong
- Database connection example:
  - Singkong.jar and h2.jar are located in current directory, on a system which
    : character is used as class path separator
  - java -cp Singkong.jar:h2.jar com.noprianto.singkong.Singkong
    >  let db = database("org.h2.Driver", "jdbc:h2:/tmp/test", "admin", "admin")
    >  db
    DATABASE (URL=jdbc:h2:/tmp/test, user=admin, driver=org.h2.Driver)     
- To test whether a database connection is valid, please use built-in function
  database_connected.
- Supported Singkong and Java type mapping:
  - BOOLEAN -> Java: boolean
  - DATE -> Java: java.sql.Date
  - NUMBER -> Java: int (if a NUMBER looks like an integer) or 
              Java: java.math.BigDecimal
  - STRING -> Java: String
  Unsupported Singkong data type in query: returns error
- To run an ARRAY of SQL queries, please use built-in function query. This
  function accepts two arguments: DATABASE and ARRAY of ARRAY. Each element 
  in the specified ARRAY must be an ARRAY of two elements: STRING (SQL command
  and ARRAY of arguments). SQL queries are run in transaction, which will
  be committed if no errors occurred. 


-----------------------------------------------------------------------------

10. Calling Java method
It is possible to call static Java method and use the returned value, to 
provide functionalities in Java Programming Language. 
- To call static Java method, please use built-in function call. This function
  accepts two-arguments: STRING (Java class name found in class path) and
  any type. This function returns STRING, ARRAY (of STRING), 
  ARRAY (of ARRAY (of STRING)), or NULL (error). 
- Please note that Java class name must be found in class path. In order to use
  class from another jar file/directory, please run Singkong using the 
  following command:
  java -cp Singkong.jar:<jar> com.noprianto.singkong.Singkong
  or
  java -cp Singkong.jar:<dir> com.noprianto.singkong.Singkong
  or
  java -cp Singkong.jar;<jar> com.noprianto.singkong.Singkong
  or
  java -cp Singkong.jar;<dir> com.noprianto.singkong.Singkong
  where <jar> is a jar file and <dir> is a directory containing the 
  class. Please note that class path separator character is operating system 
  dependent (: or ;). If the class file is located in current working directory,
  <dir> might be replaced with a ., for example:
  java -cp Singkong.jar:. com.noprianto.singkong.Singkong
- Called method must be static method named: singkong. It must require a 
  String[][] and return a String, a String[], or a String[][]. 
- When the method is called, Singkong interpreter will use STRING representation
  of Singkong value passed to Java method, if necessary. Singkong will never 
  pass a Java null to the method.
  - If it is not an ARRAY:
    - String[1][] will be created
    - Its first element will be a String[1], containing a single 
      element of STRING representation of Singkong value passed to this method
  - If it is an ARRAY:
    - String[][] will be created, whose length is the length
      of passed ARRAY
    - For each element in this ARRAY:
      - If it is not an ARRAY:
        - String[1] will be created, containing STRING representation of the
          element
      - If it is an ARRAY:
        - String[] will be created, whose length is the length of this ARRAY
        - This newly created String[] will be populated with STRING 
          representation of each element in this ARRAY
- If there is any error when calling this method, NULL will be returned. If 
  the method returns something other than String, String[], or String[][], 
  NULL will be returned. If an exception occurred, NULL will be returned.
- Example 1: 
  - HelloWorld.java in examples directory. Please make sure there is
    a static method: public static String singkong(String[][] args) {

    public class HelloWorld {
        public static String singkong_info() {
            return "HelloWorld: Description, license, ...";
        }

        public static String singkong(String[][] args) {
            StringBuilder builder = new StringBuilder();
            for (int i=0; i<args.length; i++) {
                String[] r = args[i];
                for (int j=0; j<r.length; j++) {
                    String s = r[j];
                    builder.append(s);
                    builder.append(", ");
                }
                builder.append("; ");
            }
            return builder.toString();
        }

        public static void main(String[] args) {
            System.out.println("HelloWorld: Singkong Programming Language module");
        }
    }

  - This file is compiled to HelloWorld.class

    cd examples
    javac HelloWorld.java 
    cd ..

  - Because the required HelloWorld.class is located in examples directory, 
    relative to current working directory,
    Singkong should be run using the following command: 
    java -cp Singkong.jar:examples com.noprianto.singkong.Singkong
    or (depending on the operating system)
    java -cp Singkong.jar;examples com.noprianto.singkong.Singkong

  - Singkong program can call the method (a STRING is returned):

    >  let x = call("HelloWorld", [[], [1], [2,3], [4,5,6]])
    >  x
    "; 1, ; 2, 3, ; 4, 5, 6, ; "

    >  type(x)
    "STRING"

- Example 2: 
  - HelloWorldArray.java in examples directory. Please make sure 
    there is a static method: public static String[] singkong(String[][] args). 
    Please note that this method returns String[], not String. 

    public class HelloWorldArray {
        public static String singkong_info() {
            return "HelloWorldArray: Description, license, ...";
        }

        public static String[] singkong(String[][] args) {
            String[] ret = new String[args.length];
            for (int i=0; i<args.length; i++) {
                StringBuilder builder = new StringBuilder();
                String[] r = args[i];
                for (int j=0; j<r.length; j++) {
                    String s = r[j];
                    builder.append(s);
                    builder.append(", ");
                }
                ret[i] = builder.toString();
            }
            return ret;
        }

        public static void main(String[] args) {
            System.out.println("HelloWorldArray: Singkong Programming Language module");
        }
    }

  - This file is compiled to HelloWorldArray.class

    cd examples
    javac HelloWorldArray.java
    cd ..

  - Run Singkong:
    java -cp Singkong.jar:examples com.noprianto.singkong.Singkong
    or (depending on the operating system)
    java -cp Singkong.jar;examples com.noprianto.singkong.Singkong

  - Singkong program can call the method (an ARRAY (of STRING) is returned):

    >  let x = call("HelloWorldArray", [[], [1], [2,3], [4,5,6]])
    >  x
    ["", "1, ", "2, 3, ", "4, 5, 6, "]

    >  type(x)
    "ARRAY"

    >  each(x, fn(x, y){ println(y + ": " + type(x) + ": " + x)})
    0: STRING: 
    1: STRING: 1, 
    2: STRING: 2, 3, 
    3: STRING: 4, 5, 6, 

- Example 3: 
  - HelloWorldArrayArray.java in examples directory. Please make sure 
    there is a static method: public static String[][] singkong(String[][] args). 
    Please note that this method returns String[][], not String[]. 

    public class HelloWorldArrayArray {
        public static String singkong_info() {
            return "HelloWorldArrayArray: Description, license, ...";
        }

        public static String[][] singkong(String[][] args) {
            String[][] ret = new String[args.length][];
            for (int i=0; i<args.length; i++) {
                String[] r = args[i];
                String[] x = new String[r.length];
                for (int j=0; j<r.length; j++) {
                    String s = r[j];
                    x[j] = s;
                }
                ret[i] = x;
            }
            return ret;
        }

        public static void main(String[] args) {
            System.out.println("HelloWorldArrayArray: Singkong Programming Language module");
        }
    }

  - This file is compiled to HelloWorldArrayArray.class

    cd examples
    javac HelloWorldArrayArray.java
    cd ..

  - Run Singkong:
    java -cp Singkong.jar:examples com.noprianto.singkong.Singkong
    or (depending on the operating system)
    java -cp Singkong.jar;examples com.noprianto.singkong.Singkong

  - Singkong program can call the method (an ARRAY (of ARRAY (of STRING)) is 
    returned):

    >  let x = call("HelloWorldArrayArray", [[], [1], [2,3], [4,5,6]])
    >  x
    [[], ["1"], ["2", "3"], ["4", "5", "6"]]

    >  each(x, fn(x, y){ println(y + ": " + type(x) + ": " + x)})
    0: ARRAY: []
    1: ARRAY: ["1"]
    2: ARRAY: ["2", "3"]
    3: ARRAY: ["4", "5", "6"]

- Returned String from Java method can be a valid Singkong program, that can
  be evaluated using built-in function eval (if this function is not disabled):

  - HelloWorldEval.java:

    public class HelloWorldEval {
        public static String singkong_info() {
            return "HelloWorldEval: Description, license, ...";
        }

        public static String singkong(String[][] args) {
            StringBuilder builder = new StringBuilder();
            for (int i=0; i<args.length; i++) {
                String[] r = args[i];
                for (int j=0; j<r.length; j++) {
                    String s = r[j];
                    builder.append(s);
                    builder.append(", ");
                }
                builder.append("; ");
            }

            return String.format("component(\"button\", \"%s\")", 
                builder.toString());
        }   

        public static void main(String[] args) {
            System.out.println("HelloWorldEval: Singkong Programming Language module");
        }
    }

  - Singkong program can call the method and use the returned value as Singkong
    code:

    >  let code = call("HelloWorldEval", [[], [1], [2,3], [4,5,6]])
    >  code
    "component("button", "; 1, ; 2, 3, ; 4, 5, 6, ; ")"

    >  let b = eval(code)
    >  b
    COMPONENT: button (; 1, ; 2, 3, ; 4, 5, 6, ; )

    >  add(b)
    >  show()

- To get information about the class (if provided), please use built-in function
  call_info. This function accepts one argument: STRING (Java class name found 
  in class path). The class must have a static method named: singkong_info, 
  without parameter, and return a String.

    >  call_info("HelloWorld")
    "HelloWorld: Description, license, ..."

    >  call_info("HelloWorldArray")
    "HelloWorldArray: Description, license, ..."

    >  call_info("HelloWorldArrayArray")
    "HelloWorldArrayArray: Description, license, ..."

    >  call_info("HelloWorldEval")
    "HelloWorldEval: Description, license, ..."


-----------------------------------------------------------------------------

11. Simple HTTP client
Singkong comes with simple HTTP client. 
- Default user agent: Singkong <version>
- Encode or decode: please use built-in function url_encode or url_decode 
- Read timeout can be set for each request (default: 10 seconds)
- Headers may be set for each request
- GET
  - built-in functions: http_get, http_get_file
  - Accept-Charset: UTF-8
  - Redirection from HTTP to HTTPS is supported
  - Only one redirect is followed (Location header)
  - Supported redirects: 301, 302, 303
  - To download a file, please use built-in function: http_get_file
- POST 
  - built-in functions: http_post, http_post_override
  - Accept-Charset: UTF-8
  - Content-Type: application/x-www-form-urlencoded;charset=UTF-8
  - Body may be empty
  - To do a HTTP POST with X-HTTP-Method-Override, please use built-in function
    http_post_override
- PUT
  - built-in function: http_put
  - Accept-Charset: UTF-8
  - Content-Type: application/x-www-form-urlencoded;charset=UTF-8
  - Body may be empty
- DELETE
  - built-in function: http_delete
  - Accept-Charset: UTF-8
  - Content-Type: application/x-www-form-urlencoded;charset=UTF-8
  - Body is not supported
- Unsupported method
  - If the server supports X-HTTP-Method-Override, http_post_override probably
    can be used (for example, with PATCH request method)
- Working with JSON
  - JSON is not explicitly supported in Singkong. However, HASH probably can be 
    used.
  - To convert from HASH to STRING, please use built-in function string.
  - To convert from STRING to HASH, please use built-in function parse_hash.  


-----------------------------------------------------------------------------

12. Embedding Singkong into another applications
Java applications:
- Class: com.noprianto.singkong.Singkong
- Methods: 
    public static java.lang.String evaluatorString(java.lang.String);

    public static java.lang.String evaluatorString(java.lang.String,
        java.lang.String[]);

    public static java.lang.String evaluatorString(java.lang.String,
        com.noprianto.singkong.SingkongEnvironment);

    public static java.lang.String evaluatorString(java.lang.String,
        com.noprianto.singkong.SingkongEnvironment,java.lang.String[]);

    public static void evaluatorString(java.lang.String,
        com.noprianto.singkong.SingkongEnvironment,java.io.PrintStream);

    public static void evaluatorString(java.lang.String,
        com.noprianto.singkong.SingkongEnvironment,java.io.PrintStream,
        java.lang.String[]);

- From java.util.Map to SingkongEnvironment:
    public static com.noprianto.singkong.SingkongEnvironment environmentFromMap(
        java.util.Map);


Example 1: Test.java
import com.noprianto.singkong.Singkong;

public class Test {
    public static void main(String[] args) {
        String code = "let list = [1,2,3]; println(list);";
        String output = Singkong.evaluatorString(code);
        System.out.println(output);
    }
}

javac -cp Singkong.jar Test.java 
java -cp Singkong.jar:. Test
[1, 2, 3]


Example 2: Test.java
import com.noprianto.singkong.Singkong;
  
public class Test {
    public static void main(String[] args) {
        String code = "println([1,2,3]); system();";
        String output = Singkong.evaluatorString(code, new String[]{"system"});
        System.out.println(output);
    }
}

javac -cp Singkong.jar Test.java 
java -cp Singkong.jar:. Test
[1, 2, 3]
ERROR: built-in function "system" is disabled


Example 3: Test.java
import java.util.Map;
import java.util.HashMap;
import com.noprianto.singkong.Singkong;

public class Test {
    public static void main(String[] args) {
        Map<String, Object> map = new HashMap<String, Object>();
        map.put("hello", "Hello, World");
        map.put("test", true);

        String code = "println(hello); println(test);";
        String output = Singkong.evaluatorString(code,
            Singkong.environmentFromMap(map));

        System.out.println(output);
    }
}

javac -cp Singkong.jar Test.java 
java -cp Singkong.jar:. Test
Hello, World
true


Example 4: Test.java
import java.util.Map;
import java.util.HashMap;
import com.noprianto.singkong.Singkong;

public class Test {
    public static void main(String[] args) {
        Map<String, Object> map = new HashMap<String, Object>();
        map.put("hello", "Hello, World");

        String code = "println(hello); info();";
        String output = Singkong.evaluatorString(code,
            Singkong.environmentFromMap(map),
            new String[]{"system", "info"});

        System.out.println(output);
    }
}

javac -cp Singkong.jar Test.java
java -cp Singkong.jar:. Test
Hello, World
ERROR: built-in function "info" is disabled


Example 5: Test.java
import java.io.ByteArrayOutputStream;
import java.io.PrintStream;
import java.util.HashMap;
import java.util.Map;
import com.noprianto.singkong.Singkong;

public class Test {
    public static void main(String[] args) {
        String result = "";

        Map<String, Object> map = new HashMap<String, Object>();
        map.put("hello", "Hello, World");
        map.put("test", true);

        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        try {
            PrintStream output = new PrintStream(outputStream);
            Singkong.evaluatorString("println(hello); println(test)", 
                    Singkong.environmentFromMap(map), output);
            result = outputStream.toString();
        } catch (Exception e) {
        }

        System.out.println(result);
    }
}

javac -cp Singkong.jar Test.java 
java -cp Singkong.jar:. Test
Hello, World
true


Example 6: Test.java
import java.io.ByteArrayOutputStream;
import java.io.PrintStream;
import java.util.HashMap;
import java.util.Map;
import com.noprianto.singkong.Singkong;

public class Test {
    public static void main(String[] args) {
        String result = "";

        Map<String, Object> map = new HashMap<String, Object>();
        map.put("hello", "Hello, World");

        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        try {
            PrintStream output = new PrintStream(outputStream);
            Singkong.evaluatorString("println(hello); info();",
                    Singkong.environmentFromMap(map), output,
                    new String[]{"system", "info"});
            result = outputStream.toString();
        } catch (Exception e) {
        }

        System.out.println(result);
    }
}

javac -cp Singkong.jar Test.java
java -cp Singkong.jar:. Test
Hello, World
ERROR: built-in function "info" is disabled


Another applications:
Example 7: Python
>>> import subprocess
>>> c = ['java', '-jar', 'Singkong.jar', 'puts("singkong")']
>>> o = subprocess.check_output(c)
>>> print(o)
singkong


Example 8: Python
>>> import subprocess
>>> c = ['java', '-DDISABLE=info', '-jar', 'Singkong.jar', 'info()']
>>> o = subprocess.check_output(c)
>>> print(o)
ERROR: built-in function "info" is disabled


-----------------------------------------------------------------------------

13. Differences with Monkey Programming Language
- Singkong is case-insensitive
- Identifier starts with a letter or underscore and optionally followed by 
  letters, numbers, or underscores
- null literal
- null is not printed
- Singkong has no INTEGER data type. Singkong has NUMBER data type that is
  compatible with INTEGER in Monkey, with support for decimal numbers.
- Additional operators for NUMBER: % ^ <= >=
- Additional operators for BOOLEAN: & |
- HASH: any data type can be used as key/value, maintains insertion-order
- More built-in functions
- Additional data types: DATE, COMPONENT (GUI application development), and
  DATABASE (database connection, database application development)
- Singkong uses overloaded operators for data types, as much as possible
  (for example, * for string repetition, - for string remove, - for array 
  remove, and many more).
- Repeat loop (and built-in functions: do, each for simple looping)
- Some built-in functions may be disabled when the interpreter in run 
- Singkong supports multi-line comment (between # and ;)


-----------------------------------------------------------------------------

14. Development, compatibility, and modules
- Singkong is developed on Java 8 with -source 1.5 -target 1.5
  (using Java 5.0-compatible application programming interface)
- Run tests: Java 5.0, Java 8 (main testing), and latest Java version 
- Singkong maintains backward compatibility
- List of external Singkong modules is available from Singkong website


-----------------------------------------------------------------------------

15. Example: GUI: components
reset();
let b = component("button", "Hello");
let c = component("checkbox", "Singkong?");
let m = component("combobox", "Singkong,Programming,Language");
let e = component("edit", "Hello, World");
let i = component("image", "image.jpg");
let l = component("label", "Singkong Programming Language");
let p = component("password", "test");
let r = component("radio", "Radio Button");
let t = component("table", "A,B,C,D,E");
let x = component("text", "Singkong");

add([e, t]);
add_n([i, l, x, p, c, r, m, b]);

closing("Are you sure you want to quit this application?", "Please confirm");
show();


-----------------------------------------------------------------------------

16. Example: GUI: layout
reset();
let c = component("button", "C");
let e = component("button", "E");
let n = component("button", "N");
let w = component("button", "W");

let s1 = component("button", "S 1");
let s2 = component("button", "S 2");
let s3 = component("button", "S 3");
let s = [s1, s2, s3];

add(c);
add_e(e);
add_n(n);
add_s(s);
add_w(w);

show();


-----------------------------------------------------------------------------

17. Example: GUI: Singkong information
reset();
let t = component("table","KEY,VALUE,TYPE", true);
let l = component("label", "Singkong Programming Language information");

add_n(l);
add(t);

let s = singkong();
let a = []
let f = fn(x,i) {
    let v = s[x];
    let a = a + [x, v, type(v)]; 
}
each(keys(s), f);

config(t, "contents", a);
show();


-----------------------------------------------------------------------------

18. Example: GUI: event handlers
reset();
let b = component("button", "Hello, World");
let c = component("checkbox", "Singkong?");
let r = component("radio", "Radio Button");
let m = component("combobox", "Singkong,Programming,Language");
let t = component("table", "A,B", true);
let e = component("edit", "");
let p = component("password", "");
let x = component("text", "");

let bb = fn() {
    message(get(b,"text"));
};
event(b, bb);

let cc = fn() {
    message(get(c,"active"));
};
event(c, cc);

let rr = fn() {
    message(get(r,"active"));
};
event(r, rr);

let mm = fn() {
    message(get(m, "text"));
};
event(m, mm);

config(t, "contents", [[1,2],[3,4],[5,6]]);
let tt = fn() {
    message(get(t, "contents")[get(t, "active")]);
};
event(t, tt);

let ee = fn() {
    message(get(e, "contents"));
};
event(e, ee);

let pp = fn() {
    message(get(p, "contents"));
};
event(p, pp);

let xx = fn() {
    message(get(x, "contents"));
};
event(x, xx);

add_n([p, x]);
add_s([b, c, r, m]);
add([t, e]);
show();


-----------------------------------------------------------------------------

19. Example: GUI: printing
reset();
let t = ["Singkong", "Programming", "Language"];
let s = 16;
let x = 150;
let y = 150;
let font = "monospaced";
printer(t, s, x, y, font);


-----------------------------------------------------------------------------

20. Example: GUI: simple text file editor
reset();
let e = component("edit", "");
let o = component("button", "open");
let s = component("button", "save");
let l = component("label", "");

let oo = fn() {
    let f = open();
    if (!empty(f)) {
        config(e, "contents", read(f));
        config(l, "text", f);
    }
}
event(o, oo);

let ss = fn() {
    let f = save();
    if (!empty(f)) {
        let t = get(e, "contents");
        write(f, t);
        config(l, "text", f);
    }
}
event(s, ss);

add_n(l);
add(e);
add_s([o, s]);
show();


-----------------------------------------------------------------------------

21. Example: GUI: timer
reset();
let l = component("label", string(@));
let b1 = component("button", "start");
let b2 = component("button", "stop");

add(l);
add_s([b1, b2]);

let f = fn() {
    config(l, "text", string(@));
}

let timer_start = fn() {
    timer(1000, f);
}

let timer_stop = fn() {
    stop();
}

event(b1, timer_start);
event(b2, timer_stop);

show();


-----------------------------------------------------------------------------

22. Example: Database: create table
let d = database("org.h2.Driver", "jdbc:h2:/tmp/test", "admin", "admin");
if (database_connected(d)) {
    let q = [ ["create table test(a integer, b varchar(64))", []] ]
    let r = query(d, q);
    println(r);
}


-----------------------------------------------------------------------------

23. Example: Database: insert, update, select
let d = database("org.h2.Driver", "jdbc:h2:/tmp/test", "admin", "admin");
if (database_connected(d)) {
    let q = [
        ["insert into test(a,b) values(?, ?)", [random(1,10), "hello"]],
        ["update test set b=? where b=?", ["Hello World", "hello"]]
    ]
    let r = query(d, q);
    println(r);

    let q = [ ["select * from test", []] ]
    let r = query(d, q);
    println(r);
}


-----------------------------------------------------------------------------

24. Example: GUI/Database: select
reset();
let t = component("table", "A,B", true);
add(t);

let d = database("org.h2.Driver", "jdbc:h2:/tmp/test", "admin", "admin");
if (database_connected(d)) {
    let q = [ ["select a,b from test", []] ]
    let r = query(d, q);
    if (!empty(r)) {
        config(t, "contents", r[0]);
    }
}

show();


-----------------------------------------------------------------------------

25. Example: Java: Base64 encode/decode
Note: the following modules require Java 8 or later. Please read: 
Calling Java method. The following files are saved in examples directory, 
relative to current working directory.

- Base64Encode.java (compiled to Base64Encode.class: javac Base64Encode.java)

    public class Base64Encode {
        public static String singkong_info() {
            return "Base64Encode: Base64 encode String (using Java 8 or later)";
        }

        public static String singkong(String[][] args) {
            String ret = "";
            if (args.length > 0) {
                String[] r = args[0];
                if (r.length > 0) {
                    String s = r[0];
                    ret = java.util.Base64.getEncoder().encodeToString(s.getBytes());
                }
            }
            return ret;
        }

        public static void main(String[] args) {
            System.out.println("Base64Encode: Singkong Programming Language module (using Java 8 or later)");
        }
    }

- Base64Decode.java (compiled to Base64Decode.class: javac Base64Decode.java)

    public class Base64Decode {
        public static String singkong_info() {
            return "Base64Decode: Base64 decode String (using Java 8 or later)";
        }

        public static String singkong(String[][] args) {
            String ret = "";
            if (args.length > 0) {
                String[] r = args[0];
                if (r.length > 0) {
                    String s = r[0];
                    byte[] b = java.util.Base64.getDecoder().decode(s);
                    ret = new String(b);
                }
            }
            return ret;
        }

        public static void main(String[] args) {
            System.out.println("Base64Decode: Singkong Programming Language module (using Java 8 or later)");
        }
    }

- Run Singkong:

    java -cp Singkong.jar:examples com.noprianto.singkong.Singkong
    or (depending on the operating system)
    java -cp Singkong.jar;examples com.noprianto.singkong.Singkong

- Singkong program can call these methods:

    >  let s = "Singkong Programming Language"
    >  let e = call("Base64Encode", s)
    >  e
    "U2luZ2tvbmcgUHJvZ3JhbW1pbmcgTGFuZ3VhZ2U="

    >  let d = call("Base64Decode", e)
    >  d
    "Singkong Programming Language"

    >  s == d
    true


=============================================================================
Thank you for using Singkong Programming Language.
